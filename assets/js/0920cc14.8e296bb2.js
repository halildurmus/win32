"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([["8106"],{48894(e,n,i){i.r(n),i.d(n,{metadata:()=>r,default:()=>h,frontMatter:()=>l,contentTitle:()=>t,toc:()=>c,assets:()=>d});var r=JSON.parse('{"id":"migration/5xx-to-6xx","title":"Migrating from 5.x.x to 6.x.x","description":"package:win32 version 6.x.x introduces significant","source":"@site/docs/migration/5xx-to-6xx.md","sourceDirName":"migration","slug":"/migration/5xx-to-6xx","permalink":"/docs/migration/5xx-to-6xx","draft":false,"unlisted":false,"editUrl":"https://github.com/halildurmus/win32/tree/main/website/docs/migration/5xx-to-6xx.md","tags":[],"version":"current","lastUpdatedBy":"Halil Durmus","lastUpdatedAt":1772220481000,"frontMatter":{"title":"Migrating from 5.x.x to 6.x.x"},"sidebar":"mainSidebar","previous":{"title":"Leak Tracking","permalink":"/docs/advanced/leak-tracking"},"next":{"title":"Contributing","permalink":"/docs/community/contributing"}}'),s=i(74848),a=i(28453);let l={title:"Migrating from 5.x.x to 6.x.x"},t,d={},c=[{value:"Overview of Major Changes",id:"overview-of-major-changes",level:2},{value:"<code>winsock2</code> Library Removal",id:"winsock2-library-removal",level:2},{value:"String Conversion Changes",id:"string-conversion-changes",level:2},{value:"String Extension Renames",id:"string-extension-renames",level:3},{value:"<code>TEXT()</code> Function Removal",id:"text-function-removal",level:3},{value:"Unpacking String Arrays",id:"unpacking-string-arrays",level:3},{value:"<code>BSTR</code> Class Removal",id:"bstr-class-removal",level:3},{value:"GUID Changes",id:"guid-changes",level:2},{value:"<code>Guid</code> Class Removal",id:"guid-class-removal",level:3},{value:"<code>GUIDFromString()</code> Function Removal",id:"guidfromstring-function-removal",level:3},{value:"CLSID / IID Conversion Helpers Removal",id:"clsid--iid-conversion-helpers-removal",level:3},{value:"GUID Constants",id:"guid-constants",level:3},{value:"<code>GUID.Data4</code> Field Change",id:"guiddata4-field-change",level:3},{value:"Boolean Conversions",id:"boolean-conversions",level:2},{value:"Error Handling Changes",id:"error-handling-changes",level:2},{value:"<code>HRESULT</code>-Based APIs",id:"hresult-based-apis",level:3},{value:"APIs That Call <code>SetLastError()</code>",id:"apis-that-call-setlasterror",level:2},{value:"Exception Changes",id:"exception-changes",level:2},{value:"<code>COMException</code> Removal",id:"comexception-removal",level:3},{value:"Accessing <code>HRESULT</code> Messages",id:"accessing-hresult-messages",level:3},{value:"COM API Changes",id:"com-api-changes",level:2},{value:"Explicit Lifetime Management",id:"explicit-lifetime-management",level:3},{value:"<code>QueryInterface</code>-Style Methods Return Values Directly",id:"queryinterface-style-methods-return-values-directly",level:3},{value:"<code>COMObject</code> Struct Removal",id:"comobject-struct-removal",level:3},{value:"<code>Dispatcher</code> Changes",id:"dispatcher-changes",level:2},{value:"Constructor Changes",id:"constructor-changes",level:3},{value:"<code>invoke()</code> Returns Typed Values",id:"invoke-returns-typed-values",level:3},{value:"<code>get()</code> Returns Typed Results",id:"get-returns-typed-results",level:3},{value:"<code>set()</code> Accepts Dart Values",id:"set-accepts-dart-values",level:3},{value:"Strongly Typed Win32 Handles",id:"strongly-typed-win32-handles",level:2},{value:"Enum Extension Type Changes",id:"enum-extension-type-changes",level:2},{value:"Memory Allocation (Optional)",id:"memory-allocation-optional",level:2},{value:"Other Notable Changes",id:"other-notable-changes",level:2},{value:"Binary Data Conversion",id:"binary-data-conversion",level:3},{value:"<code>FILETIME</code> Conversion Semantics",id:"filetime-conversion-semantics",level:3},{value:"<code>PROPERTYKEY</code> Constants",id:"propertykey-constants",level:3},{value:"<code>initApp()</code> Callback Signature",id:"initapp-callback-signature",level:3},{value:"<code>isWindowsRuntimeAvailable()</code> is Now a Getter",id:"iswindowsruntimeavailable-is-now-a-getter",level:3},{value:"Getting Help",id:"getting-help",level:2}];function o(e){let n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://pub.dev/packages/win32",children:(0,s.jsx)(n.code,{children:"package:win32"})})," version ",(0,s.jsx)(n.code,{children:"6.x.x"})," introduces significant\nimprovements to the Win32 API surface, focusing on ",(0,s.jsx)(n.strong,{children:"safety"}),", ",(0,s.jsx)(n.strong,{children:"ergonomics"}),",\nand ",(0,s.jsx)(n.strong,{children:"idiomatic Dart patterns"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["This guide covers ",(0,s.jsx)(n.strong,{children:"breaking changes"})," and ",(0,s.jsx)(n.strong,{children:"recommended migration patterns"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"overview-of-major-changes",children:"Overview of Major Changes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Exception-based error handling"}),": APIs that return ",(0,s.jsx)(n.a,{href:"https://pub.dev/documentation/win32/latest/win32/HRESULT-class.html",children:(0,s.jsx)(n.code,{children:"HRESULT"})})," now\nthrow ",(0,s.jsx)(n.a,{href:"https://pub.dev/documentation/win32/latest/win32/WindowsException-class.html",children:(0,s.jsx)(n.code,{children:"WindowsException"})})," ",(0,s.jsx)(n.strong,{children:"on failure"}),", instead of\nrequiring manual ",(0,s.jsx)(n.code,{children:"if (FAILED(hr)) { ... }"})," checks."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Output Values are Returned Directly"}),": APIs that previously required\npointer-based ",(0,s.jsx)(n.em,{children:"out"})," parameters now return their logical output values\ndirectly."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.strong,{children:["APIs That Call ",(0,s.jsx)(n.code,{children:"SetLastError()"})]}),": These APIs now return a\n",(0,s.jsx)(n.a,{href:"https://pub.dev/documentation/win32/latest/win32/Win32Result-class.html",children:(0,s.jsx)(n.code,{children:"Win32Result<T>"})}),", which captures both the logical return value\nand the associated last-error code atomically on the native side, ensuring the\n",(0,s.jsx)(n.strong,{children:"error state is preserved"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.strong,{children:["Win32 ",(0,s.jsx)(n.code,{children:"BOOL"})," mapped to Dart ",(0,s.jsx)(n.code,{children:"bool"})]}),": All Win32 ",(0,s.jsx)(n.code,{children:"BOOL"})," values \u2014 return\nvalues, parameters, and struct fields \u2014 are now exposed as Dart ",(0,s.jsx)(n.code,{children:"bool"})," instead\nof ",(0,s.jsx)(n.code,{children:"int"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Strongly typed Win32 handles"}),": Opaque Win32 handles (e.g., ",(0,s.jsx)(n.code,{children:"HKEY"}),", ",(0,s.jsx)(n.code,{children:"HWND"}),",\n",(0,s.jsx)(n.code,{children:"HICON"}),") are now exposed as extension types instead of raw ",(0,s.jsx)(n.code,{children:"int"})," or ",(0,s.jsx)(n.code,{children:"Pointer"}),",\nimproving readability, intent, and type safety while remaining ABI-compatible\nwith native code."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Enums as extension types"}),": Win32 enums are now represented as\n",(0,s.jsx)(n.strong,{children:"extension types"}),", improving type safety while remaining fully interoperable\nwith ",(0,s.jsx)(n.strong,{children:"int"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Modernized string APIs"}),": String conversion APIs have been streamlined, with\nclearer naming and better support for scoped allocation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Explicit COM lifetime management"}),": COM interfaces no longer use ",(0,s.jsx)(n.code,{children:"Finalizer"}),"\nfor automatic cleanup. You ",(0,s.jsx)(n.strong,{children:"must"})," now call\n",(0,s.jsx)(n.a,{href:"https://pub.dev/documentation/win32/latest/win32/IUnknown/release.html",children:(0,s.jsx)(n.code,{children:"IUnknown.release()"})})," explicitly, or use ",(0,s.jsx)(n.a,{href:"https://pub.dev/documentation/ffi/latest/ffi/Arena-class.html",children:(0,s.jsx)(n.code,{children:"Arena"})}),"\nto manage lifetimes automatically."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.strong,{children:["Scope-based lifetime management with ",(0,s.jsx)(n.code,{children:"Arena"})]}),": New APIs enable\ndeterministic, scope-based cleanup of native memory and COM objects."]}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"winsock2-library-removal",children:[(0,s.jsx)(n.code,{children:"winsock2"})," Library Removal"]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"winsock2"})," library has been removed. All Winsock APIs are now exported\ndirectly from the main ",(0,s.jsx)(n.code,{children:"win32"})," library."]}),"\n",(0,s.jsxs)(n.p,{children:["To migrate, replace the ",(0,s.jsx)(n.code,{children:"winsock2.dart"})," import with ",(0,s.jsx)(n.code,{children:"win32.dart"}),". If your code\nalready imports ",(0,s.jsx)(n.code,{children:"win32.dart"}),", simply remove the ",(0,s.jsx)(n.code,{children:"winsock2.dart"})," import:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- import 'package:win32/winsock2.dart';\n+ import 'package:win32/win32.dart';\n\n// ...\n"})}),"\n",(0,s.jsx)(n.h2,{id:"string-conversion-changes",children:"String Conversion Changes"}),"\n",(0,s.jsx)(n.p,{children:"String-related APIs have been renamed and simplified. In most cases, migration\nis mechanical."}),"\n",(0,s.jsx)(n.h3,{id:"string-extension-renames",children:"String Extension Renames"}),"\n",(0,s.jsx)(n.p,{children:"Most migrations only require renaming the extension methods:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- final ansiString = 'Hello'.toANSI();\n+ final ansiString = 'Hello'.toPcstr();\n\n- final array = ['foo', 'bar'].toWideCharArray();\n+ final array = ['foo', 'bar'].toPcwstr();\n\nfree(array);\nfree(ansiString);\n"})}),"\n",(0,s.jsxs)(n.admonition,{type:"tip",children:[(0,s.jsxs)(n.p,{children:["Instead of manually freeing strings, prefer ",(0,s.jsx)(n.code,{children:"Arena"})," for scoped allocation:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"using((arena) {\n  final ansiString = arena.pcstr('Hello');\n  final array = ['foo', 'bar'].toPcwstr(allocator: arena);\n  // ...\n});\n"})})]}),"\n",(0,s.jsxs)(n.h3,{id:"text-function-removal",children:[(0,s.jsx)(n.code,{children:"TEXT()"})," Function Removal"]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"TEXT()"})," helper has been removed. Use string extension method instead:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- final lpszClassName = TEXT('MyWindowClass');\n+ final lpszClassName = 'MyWindowClass'.toPcwstr();\n\n// ...\n\nfree(lpszClassName);\n"})}),"\n",(0,s.jsxs)(n.admonition,{type:"tip",children:[(0,s.jsxs)(n.p,{children:["Instead of manually freeing strings, prefer ",(0,s.jsx)(n.code,{children:"Arena"})," for scoped allocation:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"using((arena) {\n  final lpszClassName = arena.pcwstr('MyWindowClass');\n  // ...\n});\n"})})]}),"\n",(0,s.jsx)(n.h3,{id:"unpacking-string-arrays",children:"Unpacking String Arrays"}),"\n",(0,s.jsx)(n.p,{children:"String array helpers have been simplified. Wrap the pointer explicitly and\nconvert to a Dart list:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"final ptr = ...; // Pointer<Utf16>\n- final list = ptr.unpackStringArray(20);\n+ final list = PWSTR(ptr).toDartStringList(20);\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"bstr-class-removal",children:[(0,s.jsx)(n.code,{children:"BSTR"})," Class Removal"]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"BSTR"})," class has been removed. Instead, use string extension methods:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- final bstr = BSTR.fromString('Hello');\n+ final bstr = 'Hello'.toBstr();\n\n// ...\n\n- bstr.free();\n+ SysFreeString(bstr);\n"})}),"\n",(0,s.jsxs)(n.admonition,{type:"tip",children:[(0,s.jsxs)(n.p,{children:["Instead of manually calling ",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/windows/win32/api/oleauto/nf-oleauto-sysfreestring",children:(0,s.jsx)(n.code,{children:"SysFreeString()"})}),", prefer ",(0,s.jsx)(n.code,{children:"Arena"}),"\nfor scoped allocation:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"using((arena) {\n  final bstr = arena.bstr('Hello');\n  // ...\n});\n"})})]}),"\n",(0,s.jsx)(n.h2,{id:"guid-changes",children:"GUID Changes"}),"\n",(0,s.jsx)(n.p,{children:"GUID handling has been simplified and made more explicit. Most changes are\nmechanical."}),"\n",(0,s.jsxs)(n.h3,{id:"guid-class-removal",children:[(0,s.jsx)(n.code,{children:"Guid"})," Class Removal"]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"Guid"})," class has been removed. Use ",(0,s.jsx)(n.code,{children:"GUID"})," struct instead:"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Operation"}),(0,s.jsx)(n.th,{children:"Before"}),(0,s.jsx)(n.th,{children:"After"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Parse from string"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Guid.parse('{...}')"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"GUID('{...}')"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Zero GUID"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Guid.zero()"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"GUID.zero()"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Generate random"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Guid.generate()"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"CoCreateGuid()"})})]})]})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- final guid = Guid.parse('{6B29FC40-CA47-1067-B31D-00DD010662DA}');\n+ final guid = GUID('{6B29FC40-CA47-1067-B31D-00DD010662DA}');\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"guidfromstring-function-removal",children:[(0,s.jsx)(n.code,{children:"GUIDFromString()"})," Function Removal"]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"GUIDFromString()"})," helper has been removed. Convert to native memory via\n",(0,s.jsx)(n.code,{children:"GUID.toNative()"})," instead:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- final ptr = GUIDFromString('{...}');\n+ final ptr = GUID('{...}').toNative();\n\n// ...\n\nfree(ptr);\n"})}),"\n",(0,s.jsxs)(n.admonition,{type:"tip",children:[(0,s.jsxs)(n.p,{children:["Instead of manually freeing the pointer, prefer ",(0,s.jsx)(n.code,{children:"Arena"})," for scoped allocation:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"using((arena) {\n  final ptr = GUID('{...}').toNative(allocator: arena);\n  // ...\n});\n"})})]}),"\n",(0,s.jsx)(n.h3,{id:"clsid--iid-conversion-helpers-removal",children:"CLSID / IID Conversion Helpers Removal"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"convertToCLSID()"})," and ",(0,s.jsx)(n.code,{children:"convertToIID()"})," helpers have been removed."]}),"\n",(0,s.jsx)(n.p,{children:"Use the corresponding Win32 APIs directly:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- final clsid = convertToCLSID('{...}');\n+ using((arena) {\n+   final lpsz = arena.pcwstr('{...}');\n+   final clsid = arena.using(CLSIDFromString(lpsz), free);\n+   // ...\n+ });\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- final iid = convertToIID('{...}');\n+ using((arena) {\n+   final lpsz = arena.pcwstr('{...}');\n+   final guid = arena.using(IIDFromString(lpsz), free);\n+   // ...\n+ });\n"})}),"\n",(0,s.jsx)(n.h3,{id:"guid-constants",children:"GUID Constants"}),"\n",(0,s.jsxs)(n.p,{children:["GUID constants now return ",(0,s.jsx)(n.code,{children:"GUID"})," values instead of ",(0,s.jsx)(n.code,{children:"String"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- final guid = GUIDFromString(FOLDERID_Desktop);\n+ using((arena) {\n+   final guid = FOLDERID_Desktop.toNativeGuid(allocator: arena);\n+   // ...\n+ });\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"guiddata4-field-change",children:[(0,s.jsx)(n.code,{children:"GUID.Data4"})," Field Change"]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"Data4"})," field is now represented as ",(0,s.jsx)(n.code,{children:"Array<Uint8>"})," instead of an ",(0,s.jsx)(n.code,{children:"int"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"final guid = calloc<GUID>();\n- guid.ref.Data4 = 0x1234567890ABCDEF;\n+ final data4 = guid.ref.Data4;\n+ data4[0] = 0x12;\n+ data4[1] = 0x34;\n+ data4[2] = 0x56;\n+ data4[3] = 0x78;\n+ data4[4] = 0x90;\n+ data4[5] = 0xAB;\n+ data4[6] = 0xCD;\n+ data4[7] = 0xEF;\n"})}),"\n",(0,s.jsx)(n.p,{children:"This matches the native Windows layout exactly."}),"\n",(0,s.jsx)(n.h2,{id:"boolean-conversions",children:"Boolean Conversions"}),"\n",(0,s.jsxs)(n.p,{children:["Win32 APIs that expose boolean values via ",(0,s.jsx)(n.code,{children:"BOOL"})," now map directly to Dart\n",(0,s.jsx)(n.code,{children:"bool"}),". This applies uniformly to\n",(0,s.jsx)(n.strong,{children:"return values, parameters, and struct fields"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- if (IsWindows10OrGreater() == TRUE) {\n+ if (IsWindows10OrGreater()) {\n    // ...\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"What changed"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["All Win32 ",(0,s.jsx)(n.code,{children:"BOOL"})," return values now return ",(0,s.jsx)(n.code,{children:"bool"})]}),"\n",(0,s.jsxs)(n.li,{children:["Parameters of type ",(0,s.jsx)(n.code,{children:"BOOL"})," are now typed as ",(0,s.jsx)(n.code,{children:"bool"})]}),"\n",(0,s.jsxs)(n.li,{children:["Struct fields declared as ",(0,s.jsx)(n.code,{children:"BOOL"})," are now ",(0,s.jsx)(n.code,{children:"bool"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["This removes the need for manual comparisons against ",(0,s.jsx)(n.code,{children:"TRUE"})," / ",(0,s.jsx)(n.code,{children:"FALSE"})," and\nprevents accidental misuse of integer values where a boolean is required."]}),"\n",(0,s.jsx)(n.h2,{id:"error-handling-changes",children:"Error Handling Changes"}),"\n",(0,s.jsxs)(n.h3,{id:"hresult-based-apis",children:[(0,s.jsx)(n.code,{children:"HRESULT"}),"-Based APIs"]}),"\n",(0,s.jsxs)(n.p,{children:["Win32 functions and COM methods that return ",(0,s.jsx)(n.code,{children:"HRESULT"})," now:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsxs)(n.strong,{children:["Throw ",(0,s.jsx)(n.code,{children:"WindowsException"})," on failure"]})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Return logical output values directly"})," (instead of using ",(0,s.jsx)(n.em,{children:"out"})," parameters)"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["This eliminates manual ",(0,s.jsx)(n.code,{children:"FAILED(hr)"})," checks and pointer plumbing:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- final guid = calloc<GUID>();\n- final hr = CoCreateGuid(guid);\n- if (FAILED(hr)) {\n-   free(guid);\n-   throw WindowsException(hr);\n- }\n+ final guid = CoCreateGuid(); // Throws WindowsException on failure\nprint(guid.ref);\nfree(guid);\n"})}),"\n",(0,s.jsx)(n.p,{children:"You can still catch and handle failures explicitly:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"try {\n  CoGetApartmentType(pAptType, pAptQualifier);\n} on WindowsException catch (e) {\n  // handle error\n  if (e.hr == CO_E_NOTINITIALIZED) {\n    // specific handling\n  }\n}\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"apis-that-call-setlasterror",children:["APIs That Call ",(0,s.jsx)(n.code,{children:"SetLastError()"})]}),"\n",(0,s.jsxs)(n.p,{children:["Many Win32 APIs signal failure through their return value and store a\ncorresponding error code in the thread-local ",(0,s.jsx)(n.em,{children:"last-error"})," slot via\n",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror",children:(0,s.jsx)(n.code,{children:"SetLastError()"})}),", retrievable with\n",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror",children:(0,s.jsx)(n.code,{children:"GetLastError()"})}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"This pattern is unreliable in Dart FFI."})," Transitions between Dart and native\ncode can silently overwrite the last-error state before it is read \u2014 a known\nlimitation tracked in\n",(0,s.jsx)(n.a,{href:"https://github.com/dart-lang/sdk/issues/38832",children:"dart-lang/sdk#38832"})," with no\nreliable workaround in user code."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"package:win32"})," addresses this by wrapping affected APIs to return a\n",(0,s.jsx)(n.a,{href:"https://pub.dev/documentation/win32/latest/win32/Win32Result-class.html",children:(0,s.jsx)(n.code,{children:"Win32Result<T>"})})," instead. This type captures both the logical\nreturn value and the last-error code ",(0,s.jsx)(n.em,{children:"atomically on the native side"}),", so the\nerror state is always preserved across the FFI boundary."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- final hWnd = CreateWindowEx(...);\n- if (hWnd == 0) {\n-   final error = GetLastError(); // May be corrupted\n-   throw WindowsException(HRESULT_FROM_WIN32(error));\n- }\n+ final Win32Result(value: hWwnd, :error) = CreateWindowEx(...);\n+ if (hWnd.isNull) throw WindowsException(error.toHRESULT());\n"})}),"\n",(0,s.jsx)(n.h2,{id:"exception-changes",children:"Exception Changes"}),"\n",(0,s.jsxs)(n.h3,{id:"comexception-removal",children:[(0,s.jsx)(n.code,{children:"COMException"})," Removal"]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"COMException"})," class has been removed. It was\n",(0,s.jsx)(n.strong,{children:"not used or thrown anywhere"})," in ",(0,s.jsx)(n.code,{children:"package:win32"})," and existed only as a legacy\ntype."]}),"\n",(0,s.jsxs)(n.p,{children:["All Win32 and COM failures are represented by ",(0,s.jsx)(n.code,{children:"WindowsException"}),", which already\ncarries the underlying ",(0,s.jsx)(n.code,{children:"HRESULT"})," and provides consistent error handling across\nthe entire API surface."]}),"\n",(0,s.jsxs)(n.p,{children:["Removing ",(0,s.jsx)(n.code,{children:"COMException"})," eliminates dead API surface and avoids implying a\ndistinction that never actually existed in practice."]}),"\n",(0,s.jsxs)(n.h3,{id:"accessing-hresult-messages",children:["Accessing ",(0,s.jsx)(n.code,{children:"HRESULT"})," Messages"]}),"\n",(0,s.jsx)(n.p,{children:"Formatting error messages has been simplified and made more explicit."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- final message = WindowsException.convertWindowsErrorToString(E_NOINTERFACE);\n+ final message = E_NOINTERFACE.message;\n"})}),"\n",(0,s.jsxs)(n.p,{children:["This makes error-message retrieval a responsibility of the ",(0,s.jsx)(n.code,{children:"HRESULT"})," value\nitself, rather than a static helper on the exception type."]}),"\n",(0,s.jsx)(n.h2,{id:"com-api-changes",children:"COM API Changes"}),"\n",(0,s.jsx)(n.h3,{id:"explicit-lifetime-management",children:"Explicit Lifetime Management"}),"\n",(0,s.jsxs)(n.p,{children:["COM interfaces ",(0,s.jsx)(n.strong,{children:"no longer"})," use ",(0,s.jsx)(n.code,{children:"Finalizer"}),"s for automatic cleanup. You are\nnow responsible for releasing COM objects by calling\n",(0,s.jsx)(n.a,{href:"https://pub.dev/documentation/win32/latest/win32/IUnknown/release.html",children:"IUnknown.release()"})," when they are no longer needed."]}),"\n",(0,s.jsxs)(n.p,{children:["This makes COM object lifetimes ",(0,s.jsx)(n.strong,{children:"deterministic"})," and avoids GC-dependent\ncleanup."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"final dialog = IFileOpenDialog(...);\n// ...\n+ dialog.release(); // Must call explicitly\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"queryinterface-style-methods-return-values-directly",children:[(0,s.jsx)(n.code,{children:"QueryInterface"}),"-Style Methods Return Values Directly"]}),"\n",(0,s.jsxs)(n.p,{children:["Methods that conceptually ",(0,s.jsx)(n.em,{children:"return another interface"})," now do exactly that."]}),"\n",(0,s.jsxs)(n.p,{children:["You no longer allocate output pointers, pass IIDs manually, or check ",(0,s.jsx)(n.code,{children:"HRESULT"}),"s."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"final fileDialog = ...; // IFileDialog\n- final pIID = convertToIID(IID_IFileDialog2);\n- final ppv = calloc<COMObject>();\n- try {\n-   final hr = fileDialog.queryInterface(pIID, ppv.cast());\n-   if (FAILED(hr)) {\n-     free(ppv);\n-     throw WindowsException(hr);\n-   }\n-   final fileDialog2 = IFileDialog2(ppv.cast());\n- } finally {\n-   free(pIID);\n- }\n+ final fileDialog2 = fileDialog.queryInterface<IFileDialog2>();\n"})}),"\n",(0,s.jsxs)(n.admonition,{type:"tip",children:[(0,s.jsxs)(n.p,{children:["Use ",(0,s.jsx)(n.code,{children:"Arena"})," to manage COM lifetimes safely and concisely:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"using((arena) {\n  final fileDialog = arena.com<IFileOpenDialog>(FileOpenDialog);\n  final fileDialog2 = arena.adopt(fileDialog.queryInterface<IFileDialog2>());\n  // Both automatically released at the end of the using() block\n});\n"})})]}),"\n",(0,s.jsxs)(n.h3,{id:"comobject-struct-removal",children:[(0,s.jsx)(n.code,{children:"COMObject"})," Struct Removal"]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"COMObject"})," struct has been removed. Raw COM pointers are now represented by\nthe ",(0,s.jsx)(n.code,{children:"VTablePointer"})," typedef, which more accurately reflects what is actually\nbeing stored"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- final ppv = calloc<COMObject>();\n+ final ppv = calloc<VTablePointer>();\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"dispatcher-changes",children:[(0,s.jsx)(n.code,{children:"Dispatcher"})," Changes"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"Dispatcher"})," allows interacting with COM objects using late binding."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"v6"})," significantly simplifies ",(0,s.jsx)(n.code,{children:"Dispatcher"})," usage by:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Eliminating manual ",(0,s.jsx)(n.code,{children:"VARIANT"})," construction"]}),"\n",(0,s.jsx)(n.li,{children:"Returning strongly typed values"}),"\n",(0,s.jsx)(n.li,{children:"Making ownership and cleanup explicit"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"constructor-changes",children:"Constructor Changes"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"Dispatcher.fromCLSID()"})," now accepts ",(0,s.jsx)(n.code,{children:"GUID"})," instead of ",(0,s.jsx)(n.code,{children:"String"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["If you were using GUID constants (e.g., ",(0,s.jsx)(n.code,{children:"WinHttpRequest"}),"),\n",(0,s.jsx)(n.strong,{children:"no changes are required"}),", as they now return ",(0,s.jsx)(n.code,{children:"GUID"})," values directly."]}),"\n",(0,s.jsxs)(n.p,{children:["If you were passing string literals, wrap them in ",(0,s.jsx)(n.code,{children:"GUID()"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- final dispatcher = Dispatcher.fromCLSID('{...}');\n+ final dispatcher = Dispatcher.fromCLSID(GUID('{...}'));\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"invoke-returns-typed-values",children:[(0,s.jsx)(n.code,{children:"invoke()"})," Returns Typed Values"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"invoke()"})," no longer requires manual ",(0,s.jsx)(n.code,{children:"VARIANT"})," and ",(0,s.jsx)(n.code,{children:"DISPPARAMS"})," setup. Arguments\nare passed as Dart values, and the result is returned in a typed wrapper."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- final folderPath = BSTR.fromString(r'C:\\ExampleFolder');\n- final folderPathParam = arena<VARIANT>();\n- VariantInit(folderPathParam);\n- folderPathParam.ref\n-   ..vt = VT_BSTR\n-   ..bstrVal = folderPath.ptr;\n- final folderParams = arena<DISPPARAMS>();\n- folderParams.ref\n-   ..rgvarg = folderPathParam\n-   ..cArgs = 1;\n- final resultParam = arena<VARIANT>();\n- VariantInit(resultParam);\n- fileSystemObject.invoke('CreateFolder', folderParams, resultParam);\n- VariantClear(folderPathParam);\n- final folder = Dispatcher(resultParam.ref.pdispVal);\n+ final dispatch = fileSystemObject.invoke<IDispatch>('CreateFolder', const [\n+   r'C:\\ExampleFolder',\n+ ]);\n+ final folder = Dispatcher(dispatch.value);\n// ...\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"get-returns-typed-results",children:[(0,s.jsx)(n.code,{children:"get()"})," Returns Typed Results"]}),"\n",(0,s.jsx)(n.p,{children:"Property access is now strongly typed:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- final folderPathResult = folder.get('Path');\n- final folderPath = folderPathResult.ref.bstrVal.toDartString();\n- VariantClear(folderPathResult);\n+ final folderPathResult = folder.get<String>('Path');\n+ final folderPath = folderPathResult.value;\n+ folderPathResult.free();\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"set-accepts-dart-values",children:[(0,s.jsx)(n.code,{children:"set()"})," Accepts Dart Values"]}),"\n",(0,s.jsxs)(n.p,{children:["Property assignment no longer requires manual ",(0,s.jsx)(n.code,{children:"VARIANT"})," construction:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- final newFolderName = BSTR.fromString('ExampleFolderRenamed');\n- final newFolderNameParam = arena<VARIANT>();\n- VariantInit(newFolderNameParam);\n- newFolderNameParam.ref\n-   ..vt = VT_BSTR\n-   ..bstrVal = newFolderName.ptr;\n- folder.set('Name', newFolderNameParam);\n- VariantClear(newFolderNameParam);\n+ folder.set('Name', 'ExampleFolderRenamed');\n"})}),"\n",(0,s.jsx)(n.h2,{id:"strongly-typed-win32-handles",children:"Strongly Typed Win32 Handles"}),"\n",(0,s.jsxs)(n.p,{children:["Opaque Win32 handle types (e.g., ",(0,s.jsx)(n.code,{children:"HKEY"}),", ",(0,s.jsx)(n.code,{children:"HWND"}),") are now represented as\n",(0,s.jsx)(n.strong,{children:"extension types"})," instead of plain Dart ",(0,s.jsx)(n.code,{children:"int"})," or ",(0,s.jsx)(n.code,{children:"Pointer"})," values."]}),"\n",(0,s.jsxs)(n.p,{children:["This provides ",(0,s.jsx)(n.strong,{children:"stronger type safety"})," and clearer intent at the Dart level,\nwhile remaining fully ABI-compatible with native code."]}),"\n",(0,s.jsxs)(n.p,{children:["If an API previously returned or accepted ",(0,s.jsx)(n.code,{children:"int"})," or ",(0,s.jsx)(n.code,{children:"Pointer"}),", replace them with\nthe corresponding handle type:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- int hIcon = ExtractAssociatedIcon(...);\n+ HICON hIcon = ExtractAssociatedIcon(...);\n\n- EnumFontFamiliesEx(hDC, searchFont, lpProc.nativeFunction, 0, 0);\n+ EnumFontFamiliesEx(\n    hDC,\n    searchFont,\n    lpProc.nativeFunction,\n    const .new(0),\n    0,\n  );\n\nfinal wc = arena<WNDCLASS>();\nwc.ref\n  ..style = CS_HREDRAW | CS_VREDRAW\n-  ..hbrBackground = GetStockObject(WHITE_BRUSH)\n+  ..hbrBackground = HBRUSH(GetStockObject(WHITE_BRUSH))\n    // ...\n"})}),"\n",(0,s.jsx)(n.h2,{id:"enum-extension-type-changes",children:"Enum Extension Type Changes"}),"\n",(0,s.jsxs)(n.p,{children:["All Win32 enums are now represented as ",(0,s.jsx)(n.strong,{children:"extension types"})," instead of raw ",(0,s.jsx)(n.code,{children:"int"}),"\nconstants."]}),"\n",(0,s.jsxs)(n.p,{children:["This provides ",(0,s.jsx)(n.strong,{children:"stronger type safety"})," at the Dart level while remaining fully\nABI-compatible with ",(0,s.jsx)(n.code,{children:"int"})," and native code."]}),"\n",(0,s.jsxs)(n.p,{children:["If a function previously accepted ",(0,s.jsx)(n.code,{children:"int"})," and now accepts an enum extension type,\nsimply replace numeric literals with the corresponding enum constants:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"... CreateWindowEx(\n-  int dwExStyle,\n+  WINDOW_EX_STYLE dwExStyle,\n  ...,\n) { ... }\n\nCreateWindowEx(\n-  0,\n+  WS_EX_LEFT,\n  ...,\n);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"memory-allocation-optional",children:"Memory Allocation (Optional)"}),"\n",(0,s.jsxs)(n.p,{children:["While not required, migrating to the allocators provided by\n",(0,s.jsx)(n.code,{children:"package:ffi_leak_tracker"})," prepares your code to take advantage of\n",(0,s.jsx)(n.strong,{children:"native memory leak tracking"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"This is especially useful during development and debugging of FFI-heavy code."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- final ptr = calloc<DWORD>();\n+ final ptr = adaptiveCalloc<DWORD>();\n\n// ...\n\nfree(ptr);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Leak tracking is ",(0,s.jsx)(n.strong,{children:"opt-in"})," and has no effect unless explicitly enabled."]}),"\n",(0,s.jsxs)(n.p,{children:["For details. see the ",(0,s.jsx)(n.a,{href:"/docs/advanced/leak-tracking",children:"Leak Tracking"})," documentation."]}),"\n",(0,s.jsx)(n.h2,{id:"other-notable-changes",children:"Other Notable Changes"}),"\n",(0,s.jsx)(n.h3,{id:"binary-data-conversion",children:"Binary Data Conversion"}),"\n",(0,s.jsx)(n.p,{children:"Binary buffer conversion APIs have been renamed for clarity and consistency with\nother native conversion helpers:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"final uint8List = Uint8List(...);\n- final ptr = uint8List.allocatePointer();\n+ final ptr = uint8List.toNative();\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"filetime-conversion-semantics",children:[(0,s.jsx)(n.code,{children:"FILETIME"})," Conversion Semantics"]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"FILETIME.toDateTime()"})," API has been clarified. The parameter was renamed\nand its meaning made explicit."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- final dateTime = filetime.toDateTime(convertToLocalTimeZone: true);\n+ final dateTime = filetime.toDateTime(isUtc: false);\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Interpretation:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"isUtc: true"}),"  = Treat ",(0,s.jsx)(n.code,{children:"FILETIME"})," as UTC (no conversion)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"isUtc: false"})," = Convert to local time"]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"propertykey-constants",children:[(0,s.jsx)(n.code,{children:"PROPERTYKEY"})," Constants"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"PROPERTYKEY"})," constants are no longer exposed as static methods. They are now\ntop-level constants returning ",(0,s.jsx)(n.code,{children:"PROPERTYKEY"})," values directly:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- final pkey = PROPERTYKEY.PKEY_DeviceClass_Characteristics();\n+ final pkey = PKEY_DeviceClass_Characteristics;\n"})}),"\n",(0,s.jsx)(n.p,{children:"If a pointer is required:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"final pkey = PKEY_DeviceClass_Characteristics;\nfinal pkeyPtr = pkey.toNative();\n\n// ...\n\nfree(pkeyPtr);\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"initapp-callback-signature",children:[(0,s.jsx)(n.code,{children:"initApp()"})," Callback Signature"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"hInstance"})," parameter is now typed as ",(0,s.jsx)(n.code,{children:"HINSTANCE"})," instead of ",(0,s.jsx)(n.code,{children:"int"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"nShowCmd"})," parameter is now typed as ",(0,s.jsx)(n.code,{children:"SHOW_WINDOW_CMD"})," instead of ",(0,s.jsx)(n.code,{children:"int"}),":"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- initApp(int hInstance, List<String> args, int nShowCmd) {\n+ initApp(HINSTANCE hInstance, List<String> args, SHOW_WINDOW_CMD nShowCmd) {\n  // ...\n});\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"iswindowsruntimeavailable-is-now-a-getter",children:[(0,s.jsx)(n.code,{children:"isWindowsRuntimeAvailable()"})," is Now a Getter"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"isWindowsRuntimeAvailable()"})," is now exposed as a getter instead of a function:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:"- if (isWindowsRuntimeAvailable()) {\n+ if (isWindowsRuntimeAvailable) {\n  // ...\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"getting-help",children:"Getting Help"}),"\n",(0,s.jsxs)(n.p,{children:["If you encounter issues while migrating to ",(0,s.jsx)(n.code,{children:"v6.x.x"}),", the following steps will\nusually resolve them quickly:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Start with compiler errors"}),"\nMost breaking changes surface as type errors with actionable messages."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.strong,{children:["Review the ",(0,s.jsx)(n.a,{href:"/docs/core/functions",children:"Functions"})," documentation"]}),"\nThis explains the new return-value and error-handling patterns."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.strong,{children:["Check the ",(0,s.jsx)(n.a,{href:"/docs/advanced/com/methods",children:"COM Methods"})," documentation"]}),"\nCovers updated COM lifetimes, ",(0,s.jsx)(n.code,{children:"QueryInterface"})," semantics, and exception\nbehavior."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.strong,{children:["Check the ",(0,s.jsx)(n.a,{href:"https://github.com/halildurmus/win32/tree/main/examples",children:"examples"})," directory"]}),"\nAll examples have been fully migrated to ",(0,s.jsx)(n.code,{children:"v6.x.x"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"File an issue on GitHub"}),"\nIf something is unclear or incorrect, please open an issue. Migration feedback\nis especially valuable and helps refine the API and documentation."]}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},28453(e,n,i){i.d(n,{R:()=>l,x:()=>t});var r=i(96540);let s={},a=r.createContext(s);function l(e){let n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);